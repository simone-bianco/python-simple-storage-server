{% extends "base.html" %}

{% block title %}Login - Simple Storage{% endblock %}

{% block body %}
<div class="login-container">
    <div class="login-card">
        <div class="login-logo">
            <div class="login-logo-icon">
                <img src="{{ url_for('static', filename='img/logo.png') }}" alt="Logo" style="width: 60px; height: 60px; object-fit: contain;" onerror="this.parentElement.innerHTML='üì¶';">
            </div>
            <h1 class="login-title">Simple Storage</h1>
            <p class="login-subtitle">Accedi per gestire i tuoi file</p>
        </div>
        
        {% if error %}
        <div class="alert alert-danger mb-3">
            <span class="alert-icon">‚ö†Ô∏è</span>
            <div class="alert-content">{{ error }}</div>
        </div>
        {% endif %}
        
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                <div class="alert alert-{{ category }} mb-3">
                    <span class="alert-icon">{% if category == 'danger' %}‚ö†Ô∏è{% else %}‚ÑπÔ∏è{% endif %}</span>
                    <div class="alert-content">{{ message }}</div>
                </div>
                {% endfor %}
            {% endif %}
        {% endwith %}
        
        <form method="POST" action="{{ url_for('admin_login') }}" id="login-form">
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
            
            <div class="form-group">
                <label class="form-label" for="username">Username</label>
                <div class="form-input-icon-wrapper">
                    <span class="form-input-icon">üë§</span>
                    <input 
                        type="text" 
                        id="username" 
                        name="username" 
                        class="form-input" 
                        placeholder="Inserisci username"
                        required
                        autocomplete="username"
                    >
                </div>
            </div>
            
            <div class="form-group">
                <label class="form-label" for="password">Password</label>
                <div class="form-input-icon-wrapper">
                    <span class="form-input-icon">üîí</span>
                    <input 
                        type="password" 
                        id="password" 
                        name="password" 
                        class="form-input" 
                        placeholder="Inserisci password"
                        required
                        autocomplete="current-password"
                    >
                </div>
            </div>
            
            <button type="submit" class="btn btn-primary btn-full" id="login-btn">
                <span class="btn-text">Accedi</span>
                <span class="spinner hidden" id="login-spinner"></span>
            </button>
        </form>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
document.getElementById('login-form').addEventListener('submit', function() {
    const btn = document.getElementById('login-btn');
    const spinner = document.getElementById('login-spinner');
    btn.disabled = true;
    spinner.classList.remove('hidden');
});
</script>
{% endblock %}
